{% extends "base.html" %}

{% block content %}
<div class="dashboard">
    <div class="card fade-in">
        <h1 style="color: var(--dark); margin-bottom: 1rem;">
            <i class="fas fa-camera"></i> Take Attendance
        </h1>
        <p style="color: var(--secondary);">
            Bus {{ bus_number }} - Welcome, {{ incharge_name }}
        </p>
    </div>

    <div class="camera-container fade-in">
        <div class="camera-header">
            <h3 style="margin-bottom: 1rem; color: var(--dark);">
                <i class="fas fa-user-check"></i> Scan Student Face
            </h3>
            <div class="camera-controls">
                <button id="switchCamera" class="btn btn-outline">
                    <i class="fas fa-camera-rotate"></i> Switch Camera
                </button>
                <button id="captureBtn" class="btn btn-success">
                    <i class="fas fa-camera"></i> Capture & Scan
                </button>
            </div>
        </div>
        
        <div class="camera-preview">
            <video id="cameraFeed" autoplay playsinline></video>
            <div style="position: absolute; top: 10px; right: 10px; background: rgba(0,0,0,0.7); color: white; padding: 0.5rem; border-radius: 0.5rem; font-size: 0.9rem;">
                <i class="fas fa-bus"></i> Bus {{ bus_number }}
            </div>
        </div>
        
        <div id="studentInfo"></div>

        <div style="margin-top: 1rem; padding: 1rem; background: var(--light); border-radius: 0.5rem;">
            <h4 style="color: var(--dark); margin-bottom: 0.5rem;">
                <i class="fas fa-info-circle"></i> Instructions
            </h4>
            <ul style="text-align: left; color: var(--secondary);">
                <li>Ensure good lighting on student's face</li>
                <li>Position face clearly in the camera view</li>
                <li>Click "Capture & Scan" to mark attendance</li>
                <li>Use "Switch Camera" for front/back camera</li>
            </ul>
        </div>
    </div>

    <div class="card fade-in">
        <div style="display: flex; gap: 1rem; justify-content: center;">
            <a href="{{ url_for('incharge.dashboard') }}" class="btn btn-outline">
                <i class="fas fa-arrow-left"></i> Back to Dashboard
            </a>
            <button onclick="downloadAttendance()" class="btn btn-primary">
                <i class="fas fa-download"></i> Download Today's Report
            </button>
        </div>
    </div>
</div>

<script src="{{ url_for('static', filename='js/camera.js') }}"></script>
{% endblock %}